From bbd191bc397f78f1070f675651a7c73ff07935b5 Mon Sep 17 00:00:00 2001
From: Victor Morales <victor.morales@intel.com>
Date: Wed, 14 Oct 2015 17:22:08 -0500
Subject: [PATCH] Add support to lkvm hypervisor

Signed-off-by: Victor Morales <victor.morales@intel.com>
---
 etc/nova/nova-lkvm.conf.sample | 30 ++++++++++++++++++++++++++++++
 nova/compute/hv_type.py        |  2 ++
 2 files changed, 32 insertions(+)
 create mode 100644 etc/nova/nova-lkvm.conf.sample

diff --git a/etc/nova/nova-lkvm.conf.sample b/etc/nova/nova-lkvm.conf.sample
new file mode 100644
index 0000000..a89a7c7
--- /dev/null
+++ b/etc/nova/nova-lkvm.conf.sample
@@ -0,0 +1,30 @@
+[DEFAULT]
+
+# Name of this node.  This can be an opaque identifier.  It is
+# not necessarily a hostname, FQDN, or IP address. However,
+# the node name must be valid within an AMQP key, and if using
+# ZeroMQ, a valid hostname, FQDN, or IP address (string value)
+host = nova-lkvm
+
+# Top-level directory for maintaining nova's state (string
+# value)
+state_path = /var/lib/nova-lkvm
+
+# Driver to use for controlling virtualization. Options
+# include: libvirt.LibvirtDriver, xenapi.XenAPIDriver,
+# fake.FakeDriver, baremetal.BareMetalDriver,
+# vmwareapi.VMwareVCDriver, hyperv.HyperVDriver (string value)
+compute_driver = novalkvm.virt.lkvm.LkvmDriver
+
+# Firewall driver (defaults to hypervisor specific iptables
+# driver) (string value)
+firewall_driver = nova.virt.firewall.NoopFirewallDriver
+
+# Enable periodic tasks (boolean value)
+periodic_enable = False
+
+log_dir = /var/log/nova/
+
+[oslo_concurrency]
+
+lock_path = /run/lock/nova-lkvm
diff --git a/nova/compute/hv_type.py b/nova/compute/hv_type.py
index aaf8cc5..f885ef2 100644
--- a/nova/compute/hv_type.py
+++ b/nova/compute/hv_type.py
@@ -27,6 +27,7 @@ from nova import exception
 
 # This list is all known hypervisors
 # even if not currently supported by OpenStack.
+LKVM = "lkvm"
 BAREMETAL = "baremetal"
 BHYVE = "bhyve"
 DOCKER = "docker"
@@ -49,6 +50,7 @@ XEN = "xen"
 ZVM = "zvm"
 
 ALL = (
+    LKVM,
     BAREMETAL,
     BHYVE,
     DOCKER,
-- 
2.1.0

